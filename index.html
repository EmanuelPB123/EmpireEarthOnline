<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empire Earth Web</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empire Earth Web</title>
<style>
    body,
    html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }

    #game-container {
        width: 100%;
        height: 100%;
    }

    #top-nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 40px;
        background: rgba(255, 174, 0, 0.75);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 10px;
        z-index: 1000;

    }

    #middle-nav {
        position: fixed;
        bottom: 90px;
        left: 0;
        width: 100%;
        height: 40px;
        background: rgba(255, 174, 0, 0.75);
        color: white;
        display: flex;
        align-items: center;
        justify-content: space-around;
        z-index: 1000;
        border: inset rgb(255, 72, 0);
    }

    #bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 90px;
        background: rgba(255, 174, 0, 0.75);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        border: inset rgb(255, 72, 0);
    }

    #bottom-nav .button-grid {
        display: grid;
        gap: 0;
        justify-content: center;
    }

    .nav-button-container {
        position: relative;
    }

    .nav-button {
        width: 45px;
        height: 45px;
        font-size: 20px;
        padding: 0;
        background-color: #444;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        border: outset rgb(0, 0, 0);
    }

    .nav-button:hover {
        background-color: #555;
    }

    .resource-info {
        display: none;
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(255, 174, 0, 0.75);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 14px;
        white-space: nowrap;
        pointer-events: none;
        z-index: 9999;
    }

    .nav-button-container:hover .resource-info {
        display: block;
    }

    /*     #hud {
        position: fixed;
        top: 50px;
        left: 10px;
        background: rgba(255, 174, 0, 0.75);
        color: white;
        padding: 10px;
        border-radius: 5px;
        max-width: 300px;
        font-size: 12px;
    } */



    #side-nav {
    position: fixed;
    top: 40px; /* Altura del nav superior */
    left: 0;
    width: 140px; /* Ancho para 3 columnas de 45px cada una */
    bottom: 136px; /* Altura del nav inferior + nav del medio */
    background: rgba(255, 174, 0, 0.75);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px 0;
    z-index: 1000;
    border: inset rgb(255, 72, 0);
/*     overflow-y: auto; */
}

#side-nav .button-grid {
    display: grid;
    grid-template-columns: repeat(3, 45px);
    gap: 0px;
}

#side-nav .nav-button-container {
    margin-bottom: 1px;
}

#side-nav .nav-button {
    width: 40px;
    height: 40px;
    font-size: 16px;
}

#side-nav .resource-info {
    left: 100%;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 1px;
    border-radius: 1px;
    white-space: nowrap;
    font-size: 12px;
    visibility: hidden;
    opacity: 0;
    transition: visibility 0s, opacity 0.3s linear;
}

/* #side-nav .nav-button-container:hover .resource-info {
    visibility: visible;
    opacity: 1;
} */




    #config-menu {
        position: absolute;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255, 174, 0, 0.75);
        color: white;
        padding: 20px;
        border-radius: 0px;
        text-align: center;
        border: outset rgb(0, 0, 0);

    }

    #config-menu input {
        width: 50px;
        margin-right: 10px;
    }

    #config-menu button {
        margin-top: 20px;
    }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body>
    <div id="game-container"></div>

    <nav id="top-nav">
        <div style="flex: 1;"></div> <!-- Espacio flexible a la izquierda -->
        <p style="flex: 1; text-align: center;font-size: x-large;font-family: Arial black, Helvetica, sans-serif;"><span
                id="era-name">Prehistoria</span></p>
        <div style="flex: 1; display: flex; justify-content: flex-end; padding-right: 40px;">
            <button id="open-config">Configuración Inicial</button>
        </div>
    </nav>

    <nav id="side-nav">
        <div class="button-grid">
            <div class="nav-button-container">
                <button class="nav-button" id="create-worker"><i class="fas fa-user"></i></button>
                <div class="resource-info">Ciudadano: 20 alimento</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-soldier"><i class="fas fa-shield-alt"></i></button>
                <div class="resource-info">Soldado: 30 alimento, 10 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-archer"><i class="fas fa-bullseye"></i></button>
                <div class="resource-info">Arquero: 40 alimento, 20 madera</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-cavalry"><i class="fas fa-horse"></i></button>
                <div class="resource-info">Caballería: 50 alimento, 30 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-siege"><i class="fas fa-bomb"></i></button>
                <div class="resource-info">Asedio: 80 madera, 60 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-priest"><i class="fas fa-cross"></i></button>
                <div class="resource-info">Sacerdote: 50 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-scout"><i class="fas fa-eye"></i></button>
                <div class="resource-info">Explorador: 25 alimento</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-spearman"><i class="fas fa-khanda"></i></button>
                <div class="resource-info">Lancero: 35 alimento, 15 madera</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-catapult"><i class="fas fa-compress-arrows-alt"></i></button>
                <div class="resource-info">Catapulta: 100 madera, 40 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-healer"><i class="fas fa-plus-square"></i></button>
                <div class="resource-info">Curandero: 60 alimento, 30 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-warship"><i class="fas fa-ship"></i></button>
                <div class="resource-info">Barco de guerra: 150 madera, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>

            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
            <div class="nav-button-container">
                <button class="nav-button" id="create-hero"><i class="fas fa-crown"></i></button>
                <div class="resource-info">Héroe: 200 alimento, 100 oro</div>
            </div>
        </div>
    </nav>


    <nav id="middle-nav">
        <button id="advance-era">Avanzar Era</button>
        <p>Población: <span id="population">0</span></p>
        <p>Alimento: <span id="food">0</span></p>
        <p>Madera: <span id="wood">0</span></p>
        <p>Piedra: <span id="stone">0</span></p>
        <p>Oro: <span id="gold">0</span></p>
    </nav>

    <nav id="bottom-nav" class="edad-prehistorica">
        <div class="button-grid">
            <!-- Los botones se generarán dinámicamente con JavaScript -->
        </div>
    </nav>

    <div id="config-menu" style="display: none;">
        <!--         <h3>Configuración de Partida</h3> -->
        <p>
            <label for="initial-food">Alimento inicial:</label>
            <input type="number" id="initial-food" value="400">
        </p>
        <p>
            <label for="initial-wood">Madera inicial:</label>
            <input type="number" id="initial-wood" value="200">
        </p>
        <p>
            <label for="initial-stone">Piedra inicial:</label>
            <input type="number" id="initial-stone" value="200">
        </p>
        <p>
            <label for="initial-gold">Oro inicial:</label>
            <input type="number" id="initial-gold" value="200">
        </p>
        <p>
            <label for="food-nodes">Alimento:</label>
            <input type="number" id="food-nodes" value="10">
        </p>
        <p>
            <label for="wood-nodes">Madera:</label>
            <input type="number" id="wood-nodes" value="50">
        </p>
        <p>
            <label for="stone-nodes">Piedra:</label>
            <input type="number" id="stone-nodes" value="40">
        </p>
        <p>
            <label for="gold-nodes">Oro:</label>
            <input type="number" id="gold-nodes" value="30">
        </p>
        <button id="start-game">Comenzar Partida</button>
    </div>
    <div id="hover-info"></div>
    <script>
        let scene, camera, renderer, raycaster, mouse;
        let base, resourceNodes = [], units = [], buildings = [];
        let currentEra = 0;
        const eras = [
            { name: 'Edad Prehistórica', color: 0x8B4513 },
            { name: 'Edad de Piedra', color: 0x8B4513 },
            { name: 'Edad de Cobre', color: 0x8B4513 },
            { name: 'Edad de Bronce', color: 0x8B4513 },
            { name: 'Edad Oscura', color: 0x8B4513 },
            { name: 'Edad Media', color: 0x8B4513 },
            { name: 'Renacimiento', color: 0x8B4513 },
            { name: 'Edad Imperial', color: 0x8B4513 },
            { name: 'Edad Industrial', color: 0x8B4513 },
            { name: 'Edad Atómica (IGM)', color: 0x8B4513 },
            { name: 'Edad Atómica (IIGM)', color: 0x8B4513 },
            { name: 'Edad Atómica (Moderna)', color: 0x8B4513 },
            { name: 'Edad Digital', color: 0x8B4513 },
            { name: 'Nano Edad', color: 0x8B4513 },
            { name: 'Era Espacial', color: 0x8B4513 }
        ];
        let resources = {
            food: 0,
            wood: 0,
            stone: 0,
            gold: 0
        };
        let gameStarted = false;

        const buildingButtons = [
            { id: 'build-barracks', icon: 'fas fa-fort-awesome', name: 'Cuartel', cost: '50 madera, 30 piedra' },
            { id: 'build-farm', icon: 'fas fa-tractor', name: 'Granja', cost: '40 madera, 20 piedra' },
            { id: 'build-mine', icon: 'fas fa-gem', name: 'Mina', cost: '60 madera, 40 piedra' },
            { id: 'build-house', icon: 'fas fa-home', name: 'Casa', cost: '30 madera, 20 piedra' },
            { id: 'build-market', icon: 'fas fa-store', name: 'Mercado', cost: '70 madera, 50 piedra, 20 oro' },
            { id: 'build-temple', icon: 'fas fa-place-of-worship', name: 'Templo', cost: '100 piedra, 50 oro' },
            { id: 'build-tower', icon: 'fas fa-chess-rook', name: 'Torre', cost: '80 piedra, 40 madera' },
            { id: 'build-workshop', icon: 'fas fa-hammer', name: 'Taller', cost: '80 madera, 60 piedra' },
            { id: 'build-dock', icon: 'fas fa-ship', name: 'Muelle', cost: '100 madera, 30 piedra' },
            { id: 'build-university', icon: 'fas fa-university', name: 'Universidad', cost: '150 piedra, 100 madera, 50 oro' },
            { id: 'build-castle', icon: 'fas fa-chess-rook', name: 'Castillo', cost: '300 piedra, 200 madera, 100 oro' },
            { id: 'build-factory', icon: 'fas fa-industry', name: 'Fábrica', cost: '200 piedra, 150 madera, 80 oro' },
            { id: 'build-laboratory', icon: 'fas fa-flask', name: 'Laboratorio', cost: '180 piedra, 120 madera, 100 oro' },
            { id: 'build-spaceport', icon: 'fas fa-rocket', name: 'Puerto Espacial', cost: '500 piedra, 300 madera, 200 oro' },
            { id: 'build-ai-core', icon: 'fas fa-brain', name: 'Núcleo IA', cost: '500 piedra, 300 madera, 400 oro' },
            { id: 'build-quantum-computer', icon: 'fas fa-atom', name: 'Computadora Cuántica', cost: '600 piedra, 400 madera, 500 oro' },
            { id: 'build-fusion-reactor', icon: 'fas fa-atom', name: 'Reactor de Fusión', cost: '700 piedra, 500 madera, 600 oro' },
            { id: 'build-space-elevator', icon: 'fas fa-space-shuttle', name: 'Elevador Espacial', cost: '1000 piedra, 800 madera, 1000 oro' },
        ];

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('game-container').appendChild(renderer.domElement);

            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            createTerrain();
            setupLighting();
            setupCamera();

            updateEraButtons();
        }

        function createTerrain() {
            const geometry = new THREE.PlaneGeometry(1000, 1000);
            const material = new THREE.MeshStandardMaterial({ color: 0x4CAF50 });
            const terrain = new THREE.Mesh(geometry, material);
            terrain.rotation.x = -Math.PI / 2;
            scene.add(terrain);
        }

        function setupLighting() {
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.position.set(0, 1, 0);
            scene.add(directionalLight);
        }

        function setupCamera() {
            camera.position.set(0, 100, 200);
            camera.lookAt(0, 0, 0);
        }

        function updateEraButtons() {
            const buttonGrid = document.querySelector('#bottom-nav .button-grid');
            buttonGrid.innerHTML = ''; // Limpiar botones existentes

            let numButtons;
            switch (currentEra) {
                case 0: numButtons = 0; break; // Edad Prehistórica
                case 1: numButtons = 2; break; // Edad de Piedra
                case 2: numButtons = 4; break; // Edad de Cobre
                case 3: numButtons = 6; break; // Edad de Bronce
                case 4: numButtons = 8; break; // Edad Oscura
                case 5: numButtons = 10; break; // Edad Media
                case 6: numButtons = 12; break; // Renacimiento
                case 7: numButtons = 14; break;//Edad Imperial
                case 8: numButtons = 16; break;//Edad Industrial
                case 9: numButtons = 18; break;//Edad Atómica (IGM)
                case 10: numButtons = 18; break;//Edad Atómica (IIGM)
                case 11: numButtons = 18; break;//Edad Atómica (Moderna)
                case 12: numButtons = 18; break;//Edad Digital
                case 13: numButtons = 18; break;//Nano Edad
                case 14: numButtons = 18; break;//Era Espacial
                default: numButtons = buildingButtons.length; break; // Edades posteriores
            }

            for (let i = 0; i < numButtons && i < buildingButtons.length; i++) {
                const button = buildingButtons[i];
                const buttonHTML = `
            <div class="nav-button-container">
                <button class="nav-button" id="${button.id}"><i class="${button.icon}"></i></button>
                <div class="resource-info">${button.name}: ${button.cost}</div>
            </div>
        `;
                buttonGrid.innerHTML += buttonHTML;
            }

            // Actualizar el estilo del grid
            const columns = Math.min(numButtons, 9);
            const rows = Math.ceil(numButtons / 9);
            buttonGrid.style.gridTemplateColumns = `repeat(${columns}, 45px)`;
            buttonGrid.style.gridTemplateRows = `repeat(${rows}, 45px)`;

            addBuildingEventListeners();
        }

        function addBuildingEventListeners() {
            buildingButtons.forEach(button => {
                const element = document.getElementById(button.id);
                if (element) {
                    element.addEventListener('click', () => createBuilding(button.id.replace('build-', '')));
                }
            });
        }

        function advanceEra() {
            if (currentEra < eras.length - 1 &&
                resources.food >= 100 && resources.wood >= 50 && resources.stone >= 50 && resources.gold >= 50) {
                resources.food -= 100;
                resources.wood -= 50;
                resources.stone -= 50;
                resources.gold -= 50;

                currentEra++;
                document.getElementById('era-name').textContent = eras[currentEra].name;

                base.upgrade();
                units.forEach(unit => unit.evolve());

                updateResourceDisplay();

                const bottomNav = document.getElementById('bottom-nav');
                bottomNav.className = eras[currentEra].name.toLowerCase().replace(/ /g, '-');

                updateEraButtons();
            }
        }

        function updateResourceDisplay() {
            for (let resource in resources) {
                document.getElementById(resource).textContent = resources[resource];
            }
        }

        function startGame() {
            resources.food = parseInt(document.getElementById('initial-food').value);
            resources.wood = parseInt(document.getElementById('initial-wood').value);
            resources.stone = parseInt(document.getElementById('initial-stone').value);
            resources.gold = parseInt(document.getElementById('initial-gold').value);

            createResourceNodes();
            updateResourceDisplay();
            document.getElementById('config-menu').style.display = 'none';
            gameStarted = true;

            base = new Base();
            animate();

            updateEraButtons();
        }

        class Base {
            constructor() {
                this.level = 1;
                this.mesh = this.createMesh();
                scene.add(this.mesh);
            }

            createMesh() {
                const geometry = new THREE.BoxGeometry(10, 20, 10);
                const material = new THREE.MeshStandardMaterial({ color: eras[currentEra].color });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.set(0, 10, 0);
                return mesh;
            }

            upgrade() {
                this.level++;
                scene.remove(this.mesh);
                this.mesh = this.createMesh();
                this.mesh.scale.set(1 + this.level * 0.1, 1 + this.level * 0.1, 1 + this.level * 0.1);
                scene.add(this.mesh);
            }
        }

        class Unit {
            constructor(type) {
                this.type = type;
                this.mesh = this.createMesh();
                scene.add(this.mesh);
            }

            createMesh() {
                const geometry = new THREE.SphereGeometry(2, 32, 32);
                const material = new THREE.MeshStandardMaterial({ color: this.getColor() });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.set(Math.random() * 100 - 50, 2, Math.random() * 100 - 50);
                return mesh;
            }

            getColor() {
                switch (this.type) {
                    case 'worker': return 0x0000FF;
                    case 'soldier': return 0xFF0000;
                    default: return 0xFFFFFF;
                }
            }

            evolve() {
                scene.remove(this.mesh);
                this.mesh = this.createMesh();
                scene.add(this.mesh);
            }
        }

        class Building {
            constructor(type, position) {
                this.type = type;
                this.mesh = this.createMesh(position);
                scene.add(this.mesh);
            }

            createMesh(position) {
                let geometry, color;
                switch (this.type) {
                    case 'barracks':
                        geometry = new THREE.BoxGeometry(10, 8, 10);
                        color = 0x8B0000;
                        break;
                    case 'farm':
                        geometry = new THREE.CylinderGeometry(5, 5, 6, 8);
                        color = 0x228B22;
                        break;
                    case 'mine':
                        geometry = new THREE.ConeGeometry(5, 10, 4);
                        color = 0x708090;
                        break;
                    case 'house':
                        geometry = new THREE.BoxGeometry(8, 6, 8);
                        color = 0xA0522D;
                        break;
                    case 'market':
                        geometry = new THREE.BoxGeometry(12, 5, 12);
                        color = 0xFFD700;
                        break;
                    case 'temple':
                        geometry = new THREE.CylinderGeometry(6, 8, 12, 6);
                        color = 0xFFFFFF;
                        break;
                    case 'tower':
                        geometry = new THREE.CylinderGeometry(3, 5, 15, 8);
                        color = 0x808080;
                        break;
                    case 'workshop':
                        geometry = new THREE.BoxGeometry(10, 7, 10);
                        color = 0x8B4513;
                        break;
                    case 'dock':
                        geometry = new THREE.BoxGeometry(15, 3, 8);
                        color = 0x4682B4;
                        break;
                    case 'university':
                        geometry = new THREE.BoxGeometry(14, 10, 14);
                        color = 0x800080;
                        break;
                    case 'castle':
                        geometry = new THREE.BoxGeometry(20, 25, 20);
                        color = 0x696969;
                        break;
                    case 'factory':
                        geometry = new THREE.BoxGeometry(16, 12, 16);
                        color = 0xB22222;
                        break;
                    case 'laboratory':
                        geometry = new THREE.SphereGeometry(8, 32, 32);
                        color = 0x00FFFF;
                        break;
                    case 'spaceport':
                        geometry = new THREE.ConeGeometry(10, 20, 32);
                        color = 0xC0C0C0;
                        break;
                    case 'nanofabricator':
                        geometry = new THREE.OctahedronGeometry(8);
                        color = 0x32CD32;
                        break;
                    default:
                        geometry = new THREE.BoxGeometry(8, 8, 8);
                        color = 0x808080;
                }
                const material = new THREE.MeshStandardMaterial({ color: color });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.copy(position);
                mesh.position.y = geometry.parameters.height / 2;
                return mesh;
            }
        }

        function createUnit(type) {
            let cost;
            switch (type) {
                case 'worker':
                    cost = { food: 20 };
                    break;
                case 'soldier':
                    cost = { food: 30, gold: 10 };
                    break;
                default:
                    return;
            }

            if (canAfford(cost)) {
                deductResources(cost);
                units.push(new Unit(type));
                updateResourceDisplay();
                updatePopulation();
            }
        }

        function createBuilding(type) {
            let cost;
            switch (type) {
                case 'barracks':
                    cost = { wood: 50, stone: 30 };
                    break;
                case 'farm':
                    cost = { wood: 40, stone: 20 };
                    break;
                case 'mine':
                    cost = { wood: 60, stone: 40 };
                    break;
                case 'house':
                    cost = { wood: 30, stone: 20 };
                    break;
                case 'market':
                    cost = { wood: 70, stone: 50, gold: 20 };
                    break;
                case 'temple':
                    cost = { stone: 100, gold: 50 };
                    break;
                case 'tower':
                    cost = { stone: 80, wood: 40 };
                    break;
                case 'workshop':
                    cost = { wood: 80, stone: 60 };
                    break;
                case 'dock':
                    cost = { wood: 100, stone: 30 };
                    break;
                case 'university':
                    cost = { stone: 150, wood: 100, gold: 50 };
                    break;
                case 'castle':
                    cost = { stone: 300, wood: 200, gold: 100 };
                    break;
                case 'factory':
                    cost = { stone: 200, wood: 150, gold: 80 };
                    break;
                case 'laboratory':
                    cost = { stone: 180, wood: 120, gold: 100 };
                    break;
                case 'spaceport':
                    cost = { stone: 500, wood: 300, gold: 200 };
                    break;
                case 'nanofabricator':
                    cost = { stone: 400, wood: 250, gold: 300 };
                    break;
                default:
                    return;
            }

            if (canAfford(cost)) {
                deductResources(cost);
                const position = new THREE.Vector3(Math.random() * 100 - 50, 0, Math.random() * 100 - 50);
                buildings.push(new Building(type, position));
                updateResourceDisplay();
            }
        }

        function canAfford(cost) {
            return Object.entries(cost).every(([resource, amount]) => resources[resource] >= amount);
        }

        function deductResources(cost) {
            Object.entries(cost).forEach(([resource, amount]) => resources[resource] -= amount);
        }

        function createResourceNodes() {
            const foodNodes = parseInt(document.getElementById('food-nodes').value);
            const woodNodes = parseInt(document.getElementById('wood-nodes').value);
            const stoneNodes = parseInt(document.getElementById('stone-nodes').value);
            const goldNodes = parseInt(document.getElementById('gold-nodes').value);

            for (let i = 0; i < foodNodes; i++) createResourceNode('food');
            for (let i = 0; i < woodNodes; i++) createResourceNode('wood');
            for (let i = 0; i < stoneNodes; i++) createResourceNode('stone');
            for (let i = 0; i < goldNodes; i++) createResourceNode('gold');
        }

        function createResourceNode(type) {
            const geometry = new THREE.SphereGeometry(3, 32, 32);
            let color;
            switch (type) {
                case 'food': color = 0x00FF00; break;
                case 'wood': color = 0x8B4513; break;
                case 'stone': color = 0x808080; break;
                case 'gold': color = 0xFFD700; break;
            }
            const material = new THREE.MeshStandardMaterial({ color: color });
            const mesh = new THREE.Mesh(geometry, material);
            mesh.position.set(Math.random() * 1000 - 500, 3, Math.random() * 1000 - 500);
            scene.add(mesh);
            resourceNodes.push({ type: type, mesh: mesh });
        }

        function updatePopulation() {
            document.getElementById('population').textContent = units.length;
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        // Event Listeners
        document.getElementById('create-worker').addEventListener('click', () => createUnit('worker'));
        document.getElementById('create-soldier').addEventListener('click', () => createUnit('soldier'));
        document.getElementById('advance-era').addEventListener('click', advanceEra);
        document.getElementById('open-config').addEventListener('click', () => {
            document.getElementById('config-menu').style.display = 'block';
        });
        document.getElementById('start-game').addEventListener('click', startGame);

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>

</html>
</body>

</html>
